
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="WetBatchSizeControl.aspx.cs" Inherits="WetBatchSizeControl"%>

<!DOCTYPE html>
<html lang="zh-TW">
<head id="Head1" runat="server">
    <META http-equiv="Content-Type" content="text/html; charset=big5">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Wet Batchsize Control</title>
    <link href="../css/bootstrap.flaty.min.css" rel="stylesheet">
    
    <style>
        body {
            font-family: "Microsoft JhengHei", "Lato", "Helvetica Neue", Helvetica, Arial, sans-serif;
            background-color: #ecf0f1;
        }
        
        .main-container {
            max-width: 2000px;
            margin: 20px auto;
            padding: 0 15px;
        }
        
        .panel-custom {
            background-color: white;
            border: none;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .panel-primary {
            color: white;
            border-radius: 6px 6px 0 0;
            margin-bottom: 0;
        }
        
        .panel-heading {
            font-weight: bold;
            font-size: 18px;
            margin: 0;
        }
        
        .status-info {
            margin-bottom: 20px;
            font-size: 14px;
            color: #7b8a8b;
        }
        
        .status-info div {
            margin-bottom: 5px;
        }
        
        .error-label {
            color: #e74c3c;
            font-size: 16px;
        }
        
        .section-header {
            background: #b4bcc2;
            color: white;
            padding: 8px 15px;
            font-weight: bold;
            margin: 15px 0 10px 0;
            border-radius: 4px;
            font-size: 16px; 
            
            /*雿輻牢learfix靘皜斗筑*/
            overflow: hidden; /*閫貊嘹EhasLayout*/
            zoom: 1;
        }
        
        /*截E6/7瘛餃 clearfix*/
        .section-header:before,
        .section-header:after {
            content: "";
            display: table;
        }
        
        .section-header:after {
            clear: both;
        }
        
        /*撠.section-header銝h5脰璅撘蝵*/
        .section-header h5 {
            float: left; /*撌行筑*/
            margin: 0;
            margin-right: 15px; /* 喳游批捆靽潮頝 */
            line-height: 32px; /* 喳渲撓交擃摨血朣 */
            font-size: 16px;
            font-weight: bold;
        }
        
        .login-section {
            float: right;
            vertical-align: middle; /*游朣*/
        }
        
        .login-section label,  
        .login-section input{
            vertical-align: middle; /*游朣*/
            margin-right: 8px;
            display: inline-block;
        }
        
        .login-section label:last-of-type {
            margin-right: 0;     
        }
        
        .login-section input[type="text"],
        .login-section input[type="password"] {
            width: 140px;
            height: 20px;
            padding: 4px 8px;
            font-size: 12px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
        }
        
        .login-section input[type="checkbox"] {
            margin-right: 5px;
            vertical-align: middle;
        }
        
        .login-section label {
            font-size: 14px;
            margin-bottom: 0;
            font-weight: bold;
            line-height: 28px;
        }
        
        .form-row {
            margin-bottom: 15px;
            font-size: 14px;
            overflow: hidden; /*雿輻牢learfix靘皜斗筑*/
            zoom: 1; /*閫貊嘹EhasLayout*/
        }
        
        /*截E6/7瘛餃 clearfix*/
        .form-row:before,
        .form-row:after {
            content: "";
            display: table;
        }
        
        .form-row:after {
            clear: both;
        }
        
        .form-group {
            float: left;
            margin-right: 20px;
            margin-bottom: 10px;
        }
        
        .form-group:last-child {
            margin-right: 0;
        }
        
        .form-group label {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 4px;
            white-space: nowrap;
            vertical-align: middle; /* 游朣 */
            font-size: 14px;
            display: block;
            margin-bottom: 3px;
        }
        
        .form-control {
            display: inline-block !important;
            vertical-align: top;
            font-size: 14px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            padding: 4px 8px;
        }
        
        .form-control:focus {
            border-color: #2c3e50;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
            outline: none;
        }
        
        .form-control-sm {
            height: 28px;
        }
        
        /*頛詨交撠箏站*/
        .input-small { width: 80px; }
        .input-medium { width: 140px; }
        .input-large { width: 150px; }
        .input-xlarge { width: 200px; }
        
        .btn-custom {
            background: #b4bcc2;
            border: 1px solid #b4bcc2;
            color: white;
            padding: 4px 12px;
            font-size: 14px;
            font-weight: bold;
            border-radius: 3px;
            transition: all 0.3s ease;
            height: 28px;
            cursor: pointer;
        }
        
        .btn-custom:hover {
            background: #2c3e50;
            border-color: #2c3e50;
            color: white;
        }
        
        .filter-section-container {
            overflow: hidden;
            zoom: 1;
            margin: 15px 0;
            vertical-align: middle;
        }
        
        filter-section-container:before,
        filter-section-container:after {
            content: "";
            display: table;
        }
        
        filter-section-container:after {
            clear: both;
        }
        
        .filter-section {
            float: left;
            width: 45%;
            padding: 5px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #b4bcc2;
        }
        
        .filter-controls-row {
            overflow: hidden;
            zoom: 1;
            margin-bottom: 15px;
        }
        
        .filter-controls-row:before,
        .filter-controls-row:after {
            content: "";
            display: table;
        }
        
        .filter-controls-row:after {
            clear: both;
        }
        
        .filter-item 
        {
            float: left;
            margin-right: 4px;
            vertical-align: middle;
        }
        
        .filter-item:last-child 
        {
            margin-right: 0;
        }
        
        /* 批嗅隞嗥撖砍漲 */
        .filter-item:nth-child(1) {width: 80px;} /* Filter label */
        .filter-item:nth-child(2) {width: 140px;} /* 甈雿豢 */
        .filter-item:nth-child(3) {width: 140px;} /* 蝞摮豢 */
        .filter-item:nth-child(4) {width: 140px;} /* 璇隞嗅潸撓 */
        .filter-item:nth-child(5) {width: 80px;} /* AND/OR */
        .filter-item:nth-child(6) {width: 80px;} /* 啣 */
         
         .filter-conditions-display 
        {
            width: 100%;
            height: 50px;
            padding: 1px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            background-color: #fff;
            font-family: 'Courier New', Consolas, Monospace;
            font-size: 14px;
            resize: vertical;
            overflow-y: auto;
            box-sizing: border-box;
         }
         
        .filter-conditions-display:focus {
            border-color: #2c3e50;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.2);
            outline: none;
         }
         
         /*蝭拚豢剖*/
         .filter-buttons {
             text-align: right;
             margin-top: 5px;
         }
         
         .filter-buttons .btn
         {
             margin-left: 5px;
         }
        
        .remarks-section {
            float: left;
            width: 35%;
            padding: 0 15px 20px;
        }
        
        .form-control-textarea {
            width: 100%;
            max-width: 350px;
            height: 70px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            padding: 8px;
            font-size: 12px;
            resize: vertical;
            display: block;
        }
        
        .form-control-textarea:focus {
            border-color: #b4bcc2;
            box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.2);
            outline: none;
        }
        
        .remarks-text
        {
            background-color: #f8f9fa; /*瘛箇啗*/
            color: #495057; /*瘛梁唳摮*/
            cursor: default; /*暺隤曌璅璅撘*/
            overflow-y: auto; /*批捆憭舀*/
            line-height: 1.5; /*銵頝*/
        }
        
        .table-custom {
            width: 100%;
            font-size: 12px;
            margin-top: 15px;
            border-collapse: collapse;
            background-color: white;
            border-radius: 4px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .table-custom th {
            background: #2c3e50;
            color: white;
            padding: 10px 8px;
            text-align: center;
            font-weight: bold;
            border: none;
        }
        
        .table-custom td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
            border-right: 1px solid #ecf0f1;
        }
        
        .table-custom tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .modify-cell {
            background-color: #faf9fa !important;
        }
        
        .modify-cell select {
            font-size: 10px;
            height: 24px;
            padding: 2px 4px;
        }
        
        .main-content {
            position: relative;
            z-index: 2;
        }
        
        /* 頛亦 */
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        /* 閮舀見撘 */
        .alert 
        {
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid transparent;
            border-radius: 4px;
        }
        
        .alert-success {
            color: #3c763d;
            background-color: #dff0d8;
            border-color: #d6e9c6;
        }
        
        .alert-danger {
            color: #a94442;
            background-color: #f2dede;
            border-color: #ebccd1;
        }
        
        .alert-warning {
            color: #8a6d3b;
            background-color: #fcf8e3;
            border-color: #faebcc;
        }        
        
        .alert-info {
            color: #31708f;
            background-color: #d9edf7;
            border-color: #bce8f1;
        }           
        
        /* IE 澆捆 */
        .ie8 .form-control {
            display: inline;
            zoom: 1;
        }
        
        .ie8 .form-group,
        .ie9 .form-group {
            display: block;
            zoom: 1;
        }
        
        .ie8 .filter-item,
        .ie9 .filter-item {
            display: block;
            zoom: 1;
        }
        
        .ie8 .login-section label,
        .ie8 .login-section input,
        .ie9 .login-section label,
        .ie9 .login-section input {
            zoom: 1;
        }
        
    </style>
</head>
<body>
    <form id="form1" runat="server">
        <div class="main-container">
            <div class="panel-custom main-content">
                <!-- 璅憿 -->
                <div class="panel-primary">
                    <h1 class="panel-heading">WET BATCH SIZE CONTROL</h1>
                </div>
            
                <div class="panel-body">
                    <!-- 鞈閮 -->
                    <div class="status-info">
                        <span>敺湔唳: <span id="lastUpdateTime">2024-08-02 14:30:25</span></span> &nbsp;&nbsp;
                        <span>敺銝單: <span id="lastUploadTime">2024-08-02 14:25:10</span></span> &nbsp;&nbsp;
                        <span>蝬脤憒憿隢call#6598</span>
                    </div>
                
                    <!-- 閮舫＊蝷箏 -->
                    <asp:Panel id="pnlMessage" runat="server" visible="false" cssclass="alert">
                        <asp:Label id="lblMessage" runat="server"></asp:Label>
                    </asp:Panel>

                    <!-- 啣閮剖 -->
                    <div class="section-header">
                        <h5>Add New Setting</h5>
                        <div class="login-section">
                            <label>ID:</label>
                            <input type="text" id="userID" runat="server" class="form-control">
                            <label>Password:</label>
                            <input type="password" id="passward" runat="server" class="form-control">
                            <input type="checkbox" id="rememberMe" runat="server">
                            <label for="rememberMe">閮雿撖蝣</label>
                        </div>
                    </div>
                
                    <!-- 銵典桀 -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>EQP_ID</label>
                            <input type="text" id="txb_eqpid" runat="server" class="form-control form-control-sm input-small">
                        </div>
                        <div class="form-group">
                            <label>PRODG_ID</label>
                            <input type="text" id="txb_prodgid" runat="server" class="form-control form-control-sm input-medium">
                        </div>
                        <div class="form-group">
                            <label>PRODUCT_GROUP</label>
                            <input type="text" id="tbx_prodgrp" runat="server" class="form-control form-control-sm input-medium">
                        </div>
                        <div class="form-group">
                            <label>PRODSPEC_ID</label>
                            <input type="text" id="tbx_prodspecid" runat="server" class="form-control form-control-sm input-medium">
                        </div>
                        <div class="form-group">
                            <label>OPE_NO</label>
                            <input type="text" id="tbx_openo" runat="server" class="form-control form-control-sm input-small">
                        </div>
                        <div class="form-group">
                            <label>BATCH_SIZE</label>
                            <select id="batch_size" runat="server" class="form-control form-control-sm input-small">
                                <option value="">隢豢</option>
                                <option value="1">格</option>
                                <option value="2"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>MIN_WAFER_COUNT</label>
                            <input type="text" id="tbx_min_wafer_cnt" runat="server" class="form-control form-control-sm input-small" pattern="[0-9]*" title="隢頛詨交詨">
                        </div>
                        <div class="form-group">
                            <label>MEMO</label>
                            <input type="text" id="tbx_memo" runat="server" class="form-control form-control-sm input-large">
                        </div>
                        <div class="form-group">
                            <label>&nbsp;</label>
                            <button type="submit" id="btn_add" runat="server" onserverclick="btnAdd_SeverClick" onclientclick="return validateForm();" class="btn btn-custom">啣</button>
                        </div>
                    </div>
                
                    <!-- 蝭拚詨 -->
                    <div class="filter-section-container">
                        <div class="filter-section">
                            <div class="filter-controls-row">
                                <div class="filter-item">
                                    <label>Filter:</label>
                                </div>
                                <div class="filter-item">
                                    <select id="filterField" runat="server" class="form-control form-control-sm input-medium">
                                        <option value="EQP_ID">EQP_ID</option>
                                        <option value="PRODG_ID">PRODG_ID</option>
                                        <option value="PRODUCT_GROUP">PRODUCT_GROUP</option>
                                        <option value="PRODSPEC_ID">PRODSPEC_ID</option>
                                        <option value="OPE_NO">OPE_NO</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <select id="filterOperator" runat="server" class="form-control form-control-sm input-medium">
                                        <option value="=">蝑</option>
                                        <option value="!=">銝蝑</option>
                                        <option value=">">憭扳</option>
                                        <option value=">=">憭扳潛</option>
                                        <option value="<">撠</option>
                                        <option value="<=">撠潛</option>
                                        <option value="like_start">凋誑</option>
                                        <option value="like_end">蝯撠曆誑</option>
                                        <option value="not_like_start">銝凋誑</option>
                                        <option value="not_like_end">銝蝯撠曆誑</option>
                                        <option value="like"></option>
                                        <option value="not_like">銝</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <input type="text" id="filterValue" runat="server" placeholder="頛詨交隞嗅" class="form-control form-control-sm input-medium">
                                </div>
                                <div class="filter-item">
                                    <select id="filterLogic" runat="server" class="form-control form-control-sm input-small">
                                        <option value="AND">AND</option>
                                        <option value="OR">OR</option>
                                    </select>
                                </div>
                                <div class="filter-item">
                                    <button type="button" id="btn_addFilter" onclick="addFilterCondition();" class="btn btn-sucess btn-sm">啣蝭拚</button>
                                </div>
                            </div>
                        
                            <!--蝭拚豢隞園＊蝷箏-->
                            <div class="filter-conditions-row">
                                <textarea id="filterConditions" runat="server" class="filter-conditions-display" placeholder="蝭拚豢隞"></textarea>
                                <div class="filter-buttons">
                                    <button type="submit" id="btn_executeFilter" runat="server" onserverclick="btnExecuteFilter_ServerClick" class="btn btn-default btn-sm">瑁蝭拚</button>
                                    <button type="submit" id="btn_clearFilter" runat="server" onserverclick="btnClearFilter_ServerClick" class="btn btn-primary btn-sm">皜斗隞</button>
                                </div>
                            </div>
                        </div>
                        <div class="remarks-section">
                            <div class="form-control-textarea remarks-text">
                                <span style="color: Red; font-weight:bold">Remarks:</span><br>
                                1. 甇瑕脰身摰瑼蝯<br>
                                2. 賊瘜冽鈭<br>
                                3. 雿隤芣
                            </div>
                        </div>
                    </div>
                
                    <!-- 桀閮剖 -->
                    <div class="section-header">Current Setting</div>
                
                    <div class="table-responsive">
                        <div id="tableContainer" runat="server">
                            <!-- 鞈銵典批捆勗蝡臬Ｙ -->
                        </div>
                    </div>
                
                    <!-- 雿隤芣 -->
                    <div class="alert alert-info" style="margin-top: 20px; font-size: 12px;">
                    <strong>雿隤芣嚗</strong><br>
                    1. 銝寡”桀舀啣閮剖嚗憛怠神摰Ｗ暺啣<br>
                    2. 蝭拚詨航身摰亥岷璇隞塚舀游璇隞嗥<br>
                    3. 銵冽潔葉舐湔乩耨寧暹閮剖<br>
                    4. 暸詻具舀批嗉身摰臬衣
                    </div>
                </div>
            </div>
        </div>
    
    <!-- JavaScript  -->
    <script type="text/javascript" src="../script/jquery-3.7.0.min.js"></script>
    <script type="text/javascript">
        // jQuery 頛亙瑁
        $(document).ready(function() {
            // 詨頛詨仿霅
            $('#tbx_min_wafer_cnt').on('keypress',function(e) {
                var charCode = (e.which) ? e.which : e.keyCode;
                if (charCode > 31 && (charCode < 48 || charCode>57)) {
                    return false;                
                }
                return true;
            });

            // 頛詨亥霅
            $('#tbx_min_wafer_cnt').on('input propertypechange',function() {
                var value=this.value;
                this.value=value.replace(/[^0-9]/g, '');
            });

            // 銵冽潸 hover 
            $('.table-custom tbody tr').hover(
                function() {
                    $(this).addClass('table-hover');
                },
                function() {
                    $(this).removeClass('table-hover');
                }
            );
        });

        // 銵典桅霅賣
        function validateForm() {
            var required=['txb_eqpid', 'txb_prodgid', 'txb_prodgrp', 'txb_prodspecid', 'txb_openo'];
            for (var i=0; i<required.length; i++) {
                var field=document.getElementById(required[i]);
                if (!field || field.value == '') {
                    alert('隢憛怠神甈雿!');
                    if (field) field.focus();
                    return false;
                }
            }

            var batchSize=document.getElementById('batch_size');
            if (!batchSize || batchSize.value == '') {
                alert('隢豢Batch Size!');
                if (batchSize) batchSize.focus();
                return false;
            }
            return true;
        }

        // 啣蝭拚豢隞嗅賣
        function addFilterCondition() {
            var field=document.getElementById('filterField').value;
            var operator=document.getElementById('filterOperator').value;
            var value=document.getElementById('filterValue').value;
            var logic=document.getElementById('filterLogic').value;

            // 駁文敺蝛箸
            if (value.replace) {
                value=value.replace(/^\s+|\s+$+/g,'');
            }

            if (value == '') {
                alert('隢頛詨亦祟豢隞嗅!');
                document.getElementById('filterValue').focus();
                return;
            }

            // IE澆捆 PostBack
            __doPostBack('AddFilter',field + '|' + operator + '|' + value + '|' + logic);
        }

        // 湔唳喳賣
        function updateLastUpdateTime() {
            var now = new Date();
            var timeStr = now.getFullYear() + '-' + 
                          padZero(now.getMonth()+1) + '-' + 
                          padZero(now.getDate()) + ' ' +
                          padZero(now.getHours()) + ':' +
                          padZero(now.getMinutes()) + ':' +
                          padZero(now.getSeconds());
            var element = document.getElementById('lastUpdateTime');
            if (element) {
                if (element.textContent !== undefined) {
                    element.textContent = timeStr;
                }
                else {
                    element.innerText = timeStr;
                }            
            }
        }

        function padZero(num) {
            return num < 10 ? '0' + num : num;
        }

        // 銵冽潭雿
        function updateActive(id, isActive) {
            if (confirm('蝣箏閬霈湔迨閮剖函?')) {
                __doPostBack('updateActive',id + '|' + isActive);
            }
        }

        function deleteRecord(id) {
            if (confirm('蝣箏閬芷斗迨蝑鞈?')) {
                __doPostBack('DeleteRecord',id);
            }
        }

        // 鈭隞嗥摰賣
        function addEventHandler(element, eventType, handler) {
            if (element.addEventListener) {
                element.addEventListener(eventType,handler,false);
            }
            else if (element.attachEvent) {
                element.attachEvent('on' + eventType, handler);
            }
        }

        // Ｚ亙敺瑁
        function pageLoad() {
            // 箄”潭溶 hover  CSS
            var style=document.createElement('style');
            style.type='text/css';
            var css='.table-hover {background-color:#f5f5f5 !important;}';

            if (style.styleSheet) {
                style.styleSheet.cssText=css;
            }
            else {
                style.appendChild(document.createTextNode(css));
            }

            var head=document.getElementsByTagName('head')[0];
            if (head) {
                head.appendChild(style);
            }

            // 閮剖詨撽霅
            var waferInput = document.getElementById('tbx_min_wafer_cnt');
            if (waferInput) {
                addEventHandler(waferInput,'keypress',function(e) {
                    var charCode = (e.which) ? e.which : e.keyCode;
                    if (charCode > 31 && (charCode < 48 || charCode>57)) {
                        if (e.preventDefault) {
                            e.preventDefault();
                        }
                        else {
                            e.returnValue=false;
                        }
                        return false;
                    }
                    return true;
                });
            }
        }

        // DOMContentLoaded
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            pageLoad();
        }
        else if (document.addEventListener) {
            document.addEventListener('DOMContentLoaded',pageLoad);
        }
        else if (document.attachEvent) {
            document.attachEvent('onreadystatechange',function(){
                 if (document.readyState === 'complete') {
                    pageLoad();  
                 }   
            });
        }
        </script>
    </form>
</body>
</html>
