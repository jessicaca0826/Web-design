using System;
using System.Collections.Generic;
using System.Data;
using System.Data.OracleClient;
using System.Text;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Configuration;

public partial class WetBatchsizeControl : System.Web.UI.Page
{
private static string connectionString = ConfigurationManager.ConnectionStrings[“OracleConnection”].ConnectionString;

```
// ViewState 用於記住篩選條件和登入資訊
private string FilterConditions
{
    get { return ViewState["FilterConditions"] as string ?? ""; }
    set { ViewState["FilterConditions"] = value; }
}

private string UserID
{
    get { return ViewState["UserID"] as string ?? ""; }
    set { ViewState["UserID"] = value; }
}

private string Password
{
    get { return ViewState["Password"] as string ?? ""; }
    set { ViewState["Password"] = value; }
}

private bool RememberMe
{
    get { return ViewState["RememberMe"] as bool? ?? false; }
    set { ViewState["RememberMe"] = value; }
}

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        LoadTableData();
        UpdateStatusInfo();
    }
    else
    {
        // 功能2: 記住密碼功能
        if (RememberMe)
        {
            userID.Value = UserID;
            password.Value = Password;
            rememberMe.Checked = true;
        }
    }
}

// 功能1: 新增按鈕事件
protected void btnAdd_ServerClick(object sender, EventArgs e)
{
    try
    {
        // 取得使用者輸入的登入資訊
        string userId = userID.Value.Trim();
        string pwd = password.Value.Trim();
        bool remember = rememberMe.Checked;

        // 功能2: 記住密碼功能
        if (remember && !string.IsNullOrEmpty(userId) && !string.IsNullOrEmpty(pwd))
        {
            UserID = userId;
            Password = pwd;
            RememberMe = true;
        }

        // 驗證使用者身分
        if (!RTD_ACCESS_CONTROL(userId, pwd))
        {
            ShowMessage("身分驗證失敗，請檢查使用者ID和密碼", "error");
            RestoreLoginInfo();
            return;
        }

        // 收集表單資料
        string eqpId = txb_eqpid.Value.Trim();
        string prodgId = txb_prodgid.Value.Trim();
        string productGroup = tbx_prodgrp.Value.Trim();
        string prodspecId = tbx_prodspecid.Value.Trim();
        string opeNo = tbx_openo.Value.Trim();
        string batchSize = batch_size.Value;
        string minWaferCount = tbx_min_wafer_cnt.Value.Trim();
        string memo = tbx_memo.Value.Trim();

        // 基本驗證
        if (string.IsNullOrEmpty(eqpId))
        {
            ShowMessage("請填寫 EQP_ID", "warning");
            RestoreLoginInfo();
            return;
        }

        if (string.IsNullOrEmpty(prodgId))
        {
            ShowMessage("請填寫 PRODG_ID", "warning");
            Rest
```
